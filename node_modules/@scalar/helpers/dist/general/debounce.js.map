{
  "version": 3,
  "sources": ["../../src/general/debounce.ts"],
  "sourcesContent": ["/**\n * Options for configuring the debounce behavior.\n */\nexport type DebounceOptions = {\n  /** The delay in milliseconds before executing the function. Defaults to 100ms. */\n  delay?: number\n  /** Maximum time in milliseconds to wait before forcing execution, even with continuous calls. */\n  maxWait?: number\n}\n\n/**\n * Creates a debounced function executor that delays execution until after a specified time.\n * Multiple calls with the same key will cancel previous pending executions.\n *\n * This is useful for batching rapid updates (like auto-save or API calls) to avoid\n * unnecessary processing or network requests.\n *\n * @param options - Configuration options for delay, maxWait, and key separator\n * @returns A function that accepts a key array and callback to execute\n *\n * @example\n * const debouncedSave = debounce({ delay: 328 })\n * debouncedSave.execute(['user', '123'], () => saveUser(user))\n *\n * @example\n * // With maxWait to guarantee execution even with continuous calls\n * const debouncedSave = debounce({ delay: 328, maxWait: 2000 })\n * debouncedSave.execute(['user', '123'], () => saveUser(user))\n */\nexport const debounce = (options: DebounceOptions = {}) => {\n  const { delay = 328, maxWait } = options\n  const timeouts = new Map<string, ReturnType<typeof setTimeout>>()\n  const maxWaitTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n  const latestFunctions = new Map<string, () => unknown | Promise<unknown>>()\n\n  const cleanup = (): void => {\n    timeouts.forEach(clearTimeout)\n    maxWaitTimeouts.forEach(clearTimeout)\n    timeouts.clear()\n    maxWaitTimeouts.clear()\n    latestFunctions.clear()\n  }\n\n  /** Executes the function and cleans up all associated timeouts */\n  const executeAndCleanup = (key: string): void => {\n    // Get the latest function for this key\n    const fn = latestFunctions.get(key)\n\n    // Clear both timeout types\n    const timeout = timeouts.get(key)\n    if (timeout !== undefined) {\n      clearTimeout(timeout)\n      timeouts.delete(key)\n    }\n\n    const maxWaitTimeout = maxWaitTimeouts.get(key)\n    if (maxWaitTimeout !== undefined) {\n      clearTimeout(maxWaitTimeout)\n      maxWaitTimeouts.delete(key)\n    }\n\n    // Clear the latest function reference\n    latestFunctions.delete(key)\n\n    // Execute the function if it exists\n    if (fn !== undefined) {\n      try {\n        fn()\n      } catch {\n        // Errors are silently caught to prevent the debounce mechanism from breaking\n      }\n    }\n  }\n\n  const execute = (key: string, fn: () => unknown | Promise<unknown>): void => {\n    // Store the latest function for this key\n    latestFunctions.set(key, fn)\n\n    // Clear existing debounce timeout\n    const existingTimeout = timeouts.get(key)\n    if (existingTimeout !== undefined) {\n      clearTimeout(existingTimeout)\n    }\n\n    // Set debounce timeout\n    timeouts.set(\n      key,\n      setTimeout(() => executeAndCleanup(key), delay),\n    )\n\n    // Set maxWait timeout only if configured and this is a new sequence\n    if (maxWait !== undefined && !maxWaitTimeouts.has(key)) {\n      maxWaitTimeouts.set(\n        key,\n        setTimeout(() => executeAndCleanup(key), maxWait),\n      )\n    }\n  }\n\n  return { execute, cleanup }\n}\n"],
  "mappings": "AA6BO,MAAM,WAAW,CAAC,UAA2B,CAAC,MAAM;AACzD,QAAM,EAAE,QAAQ,KAAK,QAAQ,IAAI;AACjC,QAAM,WAAW,oBAAI,IAA2C;AAChE,QAAM,kBAAkB,oBAAI,IAA2C;AACvE,QAAM,kBAAkB,oBAAI,IAA8C;AAE1E,QAAM,UAAU,MAAY;AAC1B,aAAS,QAAQ,YAAY;AAC7B,oBAAgB,QAAQ,YAAY;AACpC,aAAS,MAAM;AACf,oBAAgB,MAAM;AACtB,oBAAgB,MAAM;AAAA,EACxB;AAGA,QAAM,oBAAoB,CAAC,QAAsB;AAE/C,UAAM,KAAK,gBAAgB,IAAI,GAAG;AAGlC,UAAM,UAAU,SAAS,IAAI,GAAG;AAChC,QAAI,YAAY,QAAW;AACzB,mBAAa,OAAO;AACpB,eAAS,OAAO,GAAG;AAAA,IACrB;AAEA,UAAM,iBAAiB,gBAAgB,IAAI,GAAG;AAC9C,QAAI,mBAAmB,QAAW;AAChC,mBAAa,cAAc;AAC3B,sBAAgB,OAAO,GAAG;AAAA,IAC5B;AAGA,oBAAgB,OAAO,GAAG;AAG1B,QAAI,OAAO,QAAW;AACpB,UAAI;AACF,WAAG;AAAA,MACL,QAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF;AAEA,QAAM,UAAU,CAAC,KAAa,OAA+C;AAE3E,oBAAgB,IAAI,KAAK,EAAE;AAG3B,UAAM,kBAAkB,SAAS,IAAI,GAAG;AACxC,QAAI,oBAAoB,QAAW;AACjC,mBAAa,eAAe;AAAA,IAC9B;AAGA,aAAS;AAAA,MACP;AAAA,MACA,WAAW,MAAM,kBAAkB,GAAG,GAAG,KAAK;AAAA,IAChD;AAGA,QAAI,YAAY,UAAa,CAAC,gBAAgB,IAAI,GAAG,GAAG;AACtD,sBAAgB;AAAA,QACd;AAAA,QACA,WAAW,MAAM,kBAAkB,GAAG,GAAG,OAAO;AAAA,MAClD;AAAA,IACF;AAAA,EACF;AAEA,SAAO,EAAE,SAAS,QAAQ;AAC5B;",
  "names": []
}
